---
apiVersion: v1
kind: Pod
metadata:
  name: echo-test
  labels:
    app.kubernetes.io/name: echo-test
spec:
  dnsPolicy: ClusterFirst
  restartPolicy: Never
  containers:
  - name: echo-test
    image: debian:12-slim
    command: ["/bin/bash", "-c"]
    args:
    - |
      set -e
      apt update
      apt install -y openssl iputils-ping
      exec /bin/bash
    tty: true
    stdin: true
    volumeMounts:
    - mountPath: "/etc/certs"
      name: echo-default-cert
    ports:
    - containerPort: 8888
      name: echo-port
  volumes:
  - name: echo-default-cert
    secret:
      items:
      - key: tls.key
        path: tls.key
      - key: tls.crt
        path: tls.cr
      - key: ca.crt
        path: ca.crt
      secretName: echo-default-cert
      defaultMode: 420
